# Reproduction Instructions for Mutation Testing Script

This document provides detailed instructions on how to run the mutation testing script (mutation.sh).
Refer to scripts/project-config-status.csv for the status of each subject-program. That file indicates
whether a project can be correctly built by scripts/build.xml when following the instructions below.

Before you can run the mutation script, you must setup the testing environment.
You must have JDK 8 as your default java/javac for most of the subject-programs.

(The following steps need to be done only once. Make sure you are in the `scripts` directory.)

1. Install the mutation programs and some dependencies.  You can do this by running:
   ```
   make
   ```

2. Load the source repository for the subject-program you wish to test.  You can load the source
   for all the subject programs with:
   ```
   make src
   ```
   If you would prefer to load just the source for a single subject program, see the instructions
   at the beginning of the file:
   ```
   ../subject-programs/README.build
   ```

3. Clone the Randoop repository from Github. After cloning, go to the Randoop directory and build the
   project. You can do this by running:
   ```
   cd build

   # Clone the Randoop repository
   git clone git@github.com:randoop/randoop.git

   # Go to the Randoop directory
   cd randoop

   # Build the project
   # Make sure you have JDK 11 for building Randoop
   ./gradlew jar

   # You may switch back to JDK 8 after building Randoop, necessary for running the mutation script

   # Move the jar files to the build directory
   mv build/libs/randoop-all-4.3.3.jar ../build/
   mv build/libs/replacecall-4.3.3.jar ../build/

   # You can now go back to the scripts directory
   # You may delete the Randoop repository after building the jar file
   ```


You are now ready to run the mutation test script.

Parameters:
    - `-v`: Enables verbose mode
    - `-r`: Redirect Randoop and Major output to `results/result/mutation_output.txt`
    - `-t`: Specifies the total time limit for Randoop to generate tests (in seconds)
    - `-c`: Specifies the time limit for Randoop to generate tests per class (in seconds), mutually exclusive with `-t`
    - `[project name]`: The name of the project (jar file name without ".jar") for which you want to generate tests
    and perform mutation testing. These should be one of the jar files in the `grt-testing/subject-programs` subdirectory.
    For example, to run the script on the `commons-lang3-3.0` project, you would run:
    ```
    ./mutation.sh commons-lang3-3.0
    ```
    If you want verbose output and direct the output to a file, you would run:
    ```
    ./mutation.sh -vr commons-lang3-3.0
    ```


The script will generate Randoop's test suites in a "build/test" subdirectory. The result subdirectory
for a specific run under 'results' also contains a copy of the test suites. Compiled tests and code
will be stored in a "build/bin" subdirectory. The script will generate various mutants of the source
project using Major and run these tests on those mutants. Each experiment can run a given number of
times and a given number of seconds per class. Various statistics of each iteration will be logged to
a file "results/info.txt".


You can also run:
    ```
    ./run-all.sh
    ```
to run the mutation testing script on all the subject-programs. This essentially runs ```./mutation.sh```
for each subject-program listed in the `project-config-status.csv` file.


**NOTE**: The latest release of Randoop does not implement functionality for Orienteering. If you wish
to work with Orienteering, you should download and build Randoop from GitHub and replace $RANDOOP_JAR
with the absolute path.  For Demand-driven (PR #1260), GRT Fuzzing (PR #1304), and Elephant Brain (PR #1347),
checkout the respective pull requests from the Randoop repository.

